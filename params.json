{
  "name": "IDES Data Preparation - .NET ",
  "tagline": "An example of the data preparation process developed using the .NET Framework",
  "body": "## IDES Data Preparation\r\nThe International Data Exchange Service (IDES) is a secure managed file transfer service that allows financial institutions and tax authorities to securely send information on financial accounts held by U.S. taxpayers in accordance with the Foreign Account Tax Compliance Act (FATCA). Files transmitted via IDES must be encrypted and packaged in accordance with published data preparation instructions.  The data preparation process is an important step to ensure that information transmitted via IDES conforms to U.S security standards to safeguard sensitive information.\r\n\r\nThe IDES Data Preparation.NET project repository demonstrates a sample working application built using [Microsoft Visual Studio 2015 Community edition](https://www.visualstudio.com/en-us/products/visual-studio-community-vs.aspx). The 2013 version of Visual Studio Community works as well.  An application was also developed using Java, see [IDES Data Preparation Java]  (http://irsgov.github.io/IDES-Data-Preparation-Java) for more information.\r\n\r\nThe example explains how to use the code to develop an application that will create an IDES data packet and decrypt notifications. The project starts with a validated FATCA XML file. The application does not validate the XML or metadata schemas. The sample application will digitally sign, encrypt, compress, and archive the data packet into a compliant .ZIP format.  \r\n\r\nPlease note that there are many open market tools that produce the same results; however, the IRS does not endorse any commercial products, including the frameworks used in the example.  \r\n\r\n### Create a New Project  \r\n\r\n\r\n![Image 1](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img1.png)  \r\nFigure 1   \r\n\r\n \r\nOpen **Visual Studio**, select **New Project**.   \r\n\r\n \r\n![Image 2](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img2.png)  \r\nFigure 2  \r\n\r\n\r\nUnder **New Project**, select the settings Visual C#, Windows Desktop and Windows Forms Application. Verify the settings, name and location. Click **OK** to continue.  \r\n\r\n### Download Zip Code\r\nFrom this walkthrough, download the .zip file by clicking on the zip folder icon in the upper right of the screen.\r\n\r\n![Image 3](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug10.png)  \r\nFigure 3  \r\n\r\n\r\n### Extract Zip Contents\r\nThe contents of the zip file should be extracted. From the extracted contents, copy the highlighted files and folders below. You will copy these into the new project you just created. You need the Helpers folder, the Form1.cs, Form1.Designer.cs, Form1.resx, and Program.cs files. \r\n\r\n![Image 4](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug20.png)  \r\nFigure 4\r\n\r\nOpen a folder containing the newly created application on your file system. It should look similar to this and have these files. The highlighted files from the .zip extract above should be copied into your application folder.\r\n![Image 5](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug30.png)  \r\nFigure 5\r\n\r\nWith the extracted zip files copied into your application folder, it should look similar to this.\r\n![Image 6](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug40.png)  \r\nFigure 6\r\n\r\nWhen you go back into Visual Studio, you will be prompted to update the solution. Select Yes to All to refresh the solution with the new files.\r\n![Image 7](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug50.png)  \r\nFigure 7\r\n\r\nThe updated solution will look like the screen below.\r\n![Image 8](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug60.png)  \r\nFigure 8\r\n\r\n### Importing Class Files   \r\n  \r\nIn **Solution Explorer**, add a new folder named **Helpers** that will contain class files or modules for different phases of the application. \r\nRight click the Project name in the Solution Explorer and select Add --> New Folder. This folder will be named Helpers. \r\n![Image 9](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug70.png)  \r\nFigure 9\r\n\r\nThis shows the newly created Helpers folder.\r\n![Image 10](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug80.png)  \r\nFigure 10\r\n\r\nAdd the class files from the Helpers folder into the application. You will need to right click the new Helpers folder and select Add --> Existing Item\r\n![Image 11](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug90.png)  \r\nFigure 11\r\n\r\nSelect all 6 of the files in the Helpers folder that is in your new project. You should have all 6 below selected and this will import these into the application.\r\n![Image 12](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug100.png)  \r\nFigure 12\r\n\r\nYou should now have a Helpers folder in your project and be able to see the 6 class files within it.\r\n![Image 13](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug110.png)  \r\nFigure 13\r\n\r\n### Adding References   \r\nUnder the Project menu, select the Add Reference option. This will pull up a screen of all references that can be added. \r\n![Image 13](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug120.png)  \r\nFigure 13\r\n\r\nNext, you will add a reference to the each of the following:\r\n* System.IO.Compression\r\n* System.IO.Compression.FileSystem\r\n* System.Security  \r\n* WindowsBase\r\n* System.Drawing (may already be selected in Visual Studio 2015)\r\n Select the checkbox next to each entry and click **OK**.\r\n![Image 14](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug130.png)  \r\nFigure 14\r\n\r\n### Add WinSCP\r\nFrom the Tools menu, select the NuGet Package Manager --> Package Manager Console. This may show as the Library Package Manager instead of the NuGet Package Manager in Visual Studio 2013.\r\n![Image 15](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug140.png)  \r\nFigure 15\r\n\r\nThis will open the Package Manager Console shown below.\r\n![Image 16](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug150.png)  \r\nFigure 16\r\n\r\nType “Install-Package WinSCP” in the Console and hit enter.\r\n![Image 17](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug160.png)  \r\nFigure 17\r\n\r\nThis will install the WinSCP package. A sucessful installation message should be seen in the Console.\r\n![Image 18](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug170.png)  \r\nFigure 18\r\n\r\n### Running Application\r\nClicking the start button should now give you the completed application.\r\n![Image 19](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/aug180.png)  \r\nFigure 19\r\n\r\n\r\n## Create a Transmission File\r\n\r\nTo create a transmission file for IDES, you are required to have (1) an .xml file, (2) a private key that will be used to sign the xml, and (3) the public key of the receiver. The file names are case sensitive and any variation in name, extension or format will cause a transmission failure.  There are no file extensions, unless otherwise noted. For more information, review the IDES User Guide.  \r\n\r\n1.  Select the Create Data Packet tab\r\n2.  Select the .xml file. The file should be correctly named  to create the correct sender metadata file. For example, Canada (ISO Code = 124) requires a file to be named 000000.00000.TA.124.xml.\r\n3.  Select the sender’s private key. The application uses a **.p12** file that contains the private key. The key may be in a different format, such as a .pfx file.\r\n4.  If there is a password on the key file above, enter it here. \r\n5.  Select the receiver’s public key. This will be the IRS Public Key. This may be in a different format, such as a .cer, .pfx, or .p12 extension.\r\n6.  If there is a password on the public key, enter it here.\r\n7.  Select the Tax Year. This will be used in the metadata file.\r\n\r\n\r\n\r\n![Image 20](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img10.png)\r\nFigure 20  \r\n\r\n6.  Click the **Sign and Encrypt XML** button. If the files and keys are set up correctly, a success message dialog box will appear. Click **OK** to continue.   \r\n\r\n\r\n![Image 21](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img11.png)  \r\nFigure 21    \r\n\r\n\r\n### Creating a .ZIP File   \r\n\r\nThe **Sign and Encrypt XML** button creates a .zip file that contains the key, payload, and sender metadata xml file. The zip filename should follow proper naming conventions and any variation in name, extension or format will cause a transmission failure. For example, the filename is 20150115T174443889Z_000000.00000.TA.124.zip. The contents of the sample .zip file are shown in Figure 12 below.  \r\n\r\n\r\n![Image 22](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img12.png)  \r\nFigure 22  \r\n\r\nNext, you are ready to upload the transmission into IDES. For more information on using IDES, review the [IDES User Guide](http://www.irs.gov/Businesses/Corporations/International-Data-Exchange-Service).    \r\n\r\n\r\n## Decrypting a Notification   \r\n\r\nThe application can be used to decrypt system notifications received in IDES. To decrypt the notification, the receiver must use their private key.  \r\n\r\n\r\n1.  In IDES, download or save the notification to your hard drive.  Select the downloaded .zip notification file.\r\n2.  Select the Decrypt Notification tab.\r\n3.  Select the private key of the receiver. The sample uses a .p12 format; however, the file can be modified for other formats.\r\n4.  If there is a password on the private key, enter it here.\r\n5.  The notification output folder controls the location of the decrypted output.  \r\n6.  Click the **Decrypt Notification** button.   \r\n\r\n\r\n![Image 23](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img13.png)  \r\nFigure 23  \r\n\r\n6.  If the correct key and password (optional) are used on the file, a success message dialog box will appear.  \r\n7.  In the **Notification Output Folder** field, the location of the decrypted and signed xml file that contains the contents of the notification are present. For example, the file name 000000.00000.TA.840_Payload.xml is used in this sample.  \r\n\r\n\r\n![Image 24](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img14.png)\r\nFigure 24  \r\n\r\n## Additional Features\r\n\r\nThe repository includes additional documentation that explains how the new SFTP connectivity, schema validation, digital signature validation, and multi-file processing work.\r\n\r\n### Disclaimer:\r\nWe waive copyright and related rights in the work worldwide through the CC0 1.0 Universal public domain dedication. Unless expressly stated otherwise, the person who associated a work with this deed makes no warranties about the work, and disclaims liability for all uses of the work, to the fullest extent permitted by applicable law. When using or citing the work, you should not imply endorsement by the author or the affirmer.\r\n",
  "google": "",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}